!function(a){"use strict";function b(a,b){var c=null;if(a&&a.childNodes){c=[];for(var d=a.childNodes.length;d--;)1!=a.childNodes[d].nodeType||b&&a.childNodes[d].nodeName!=b||(c[c.length]=a.childNodes[d])}return c.reverse()}function c(a,b){var c=m.Getters[b];return c?c.call(a):a.getAttribute(b)}function d(a,b){for(var c=b.length;c--;)if(a==b[c])return!0;return!1}function e(a){return a?a.replace(j,""):""}function f(a){if(!a)return"";for(var b=a.length,c="",d=!1;b--;)("]"==a[b]||")"==a[b])&&(d=!0),("["==a[b]||"("==a[b])&&(d=!1),d&&" "==a[b]||(c=a[b]+c);return c}function g(a){for(var b=a.split(i),c=b.length,d=[];c--;)d[d.length]=h(b[c]);return d.reverse()}function h(b){for(var c=[],d=f(b).split(" ").reverse(),e=d.length,g=null,h=0,i=0,j=0;e--;){var m=d[e];if(1!=m.length||"+"!=m&&"*"!=m&&"~"!=m&&">"!=m){var n=m.match(k),o=n[2],p=n[3],q=n[4],r=n[5],s={};if(c[c.length]=s,s.scope=g||"*",g=null,s.tagName=n[1],o&&(s.ID=o?o.substring(1,o.length):a),p&&(s.classes=p.substring(1,p.length).split(".")),q){s.attributes=[];var t=q.length,u=q.substring(1,t).substring(0,t-2).split("][");for(i=0,j=u.length;j>i;i++){var v={},w=u[i];if(s.attributes[s.attributes.length]=v,h=w.indexOf("="),h>=0){var x=w.match(l);v.name=w.substring(0,h-(x?1:0)),v.expected=w.substring(h+1,w.length),v.operator=(x?x[0]:"")+"="}else v.name=w}}if(r){s.pseudos=[];var y=r.substring(1,r.length).split(":");for(i=0,j=y.length;j>i;i++){var z={},A=y[i];s.pseudos[s.pseudos.length]=z,h=A.indexOf("("),h>=0?(A=A.substring(0,A.length-1),z.name=A.substring(0,h),z.param=A.substring(h+1,A.length)):z.name=A}}}else g=m}return c}var i=/\s?,\s?/g,j=/^\s+|\s+$/gm,k=/^([a-z0-9]*?)?(#.*?)?(\..*?)?(\[.*\])?(:.*?)?$/i,l=/[\^\$\*~\|!]/,m={Operators:{"=":function(a,b){return a==b},"~=":function(a,b){for(var c=b.split(" ");c.length;)if(a==c.shift())return!0;return!1},"|=":function(a,b){return a==b||0===b.indexOf(a+"-")},"^=":function(a,b){return 0===b.indexOf(a)},"$=":function(a,b){return b.indexOf(a)===b.length-a.length},"*=":function(a,b){return b.indexOf(a)>-1}},Getters:{"class":function(){return"className"in this?this.className:this.getAttribute("class")},"for":function(){return"htmlFor"in this?this.htmlFor:this.getAttribute("for")},href:function(){return"href"in this?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return this.style?this.style.cssText:this.getAttribute("style")}},createFilter:function(a){return function(b){var d=c(b,a.name);return a.operator&&a.expected?m.Operators[a.operator](e(a.expected),d):null!==d&&d.length>0}}},n={Filters:{nth:function(a,c,d){var e=b(a.parentNode,d?a.nodeName:null);return e&&e[c-1]==a},"nth-last":function(a,c,d){var e=b(a.parentNode,d?a.nodeName:null);return e&&e[e.length-c]==a},only:function(a,c){var d=b(a.parentNode,c?a.nodeName:null);return d&&1==d.length&&d[0]==a}},Methods:{"only-of-type":function(a){return n.Filters.only(a,!0)},"first-of-type":function(a){return n.Filters.nth(a,1,!0)},"last-of-type":function(a){return n.Filters["nth-last"](a,1,!0)},"nth-of-type":function(a,b){return n.Filters.nth(a,b,!0)},"nth-last-of-type":function(a,b){return n.Filters["nth-last"](a,b,!0)},"only-child":function(a){return n.Filters.only(a,!1)},"first-child":function(a){return n.Filters.nth(a,1,!1)},"last-child":function(a){return n.Filters["nth-last"](a,1,!1)},"nth-child":function(a,b){return n.Filters.nth(a,b,!1)},"nth-last-child":function(a,b){return n.Filters["nth-last"](a,b,!1)},empty:function(a){var c=b(a);return!c||0===c.length},enabled:function(a){return!a.disabled},disabled:function(a){return a.disabled},checked:function(a){return a.checked||a.selected},selected:function(a){return a.selected},focus:function(a){return a==document.activeElement},contains:function(a,b){return(a.innerText||a.textContent||"").indexOf(b)>-1},not:function(a,b){return!o.match(a,b)}},createFilter:function(a){return function(b){return n.Methods[a.name](b,e(a.param))}}},o={parse:function(a){var b=null;return b=a&&a.indexOf(",")>=0?g(a):h(a),{expressions:b,length:b.length,raw:a}},explain:function(a){var b=o.parse(a),c={selector:a,parsed:b,specificity:[0,0,0],category:"universal",key:"*"},d=b.expressions[b.length-1];"undefined"!=typeof d.ID?(c.category="id",c.key=d.ID):"undefined"!=typeof d.classes?(c.category="class",c.key=d.classes[0]):"undefined"!=typeof d.tagName&&(c.category="tag",c.key=d.tagName);for(var e=b.length;e--;){var f=b.expressions[e];if("undefined"!=typeof f.ID&&c.specificity[0]++,"undefined"!=typeof f.classes&&(c.specificity[1]+=f.classes.length),"undefined"!=typeof f.attributes&&(c.specificity[1]+=f.attributes.length),"undefined"!=typeof f.tagName&&c.specificity[2]++,"undefined"!=typeof f.pseudos)for(var g=f.pseudos.length;g--;){var h=f.pseudos[g].name;"first-line"==h||"first-letter"==h||"before"==h||"after"==h?c.specificity[2]++:c.specificity[1]++}}return c},match:function(a,b){var c=o.parse(b).expressions[0],e=c.ID,f=c.tagName,g=c.classes,h=c.attributes,i=c.pseudos,j=0;if(e&&a.id!=e)return!1;if(f&&a.tagName!=f.toUpperCase())return!1;if(g){var k=a.className.split(" ");for(j=g.length;j--;)if(!d(g[j],k))return!1}if(h)for(j=h.length;j--;)if(!m.createFilter(h[j]).call(null,a))return!1;if(i)for(j=i.length;j--;)if(!n.createFilter(i[j]).call(null,a))return!1;return!0}};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("Spiffy",[],function(){return o}):"undefined"!=typeof module?module.exports=o:this.Spiffy=o}.call(this);